(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{IVDS:function(e,l,n){"use strict";n.r(l);var t=n("8Y7J");class s{constructor(e){this.partieService=e}ngOnInit(){this.partie=this.partieService.getPartie()}}class i{}var u=n("pMnS"),o=n("SVse"),r=function(e){return e[e.OCEAN=0]="OCEAN",e[e.MER=1]="MER",e[e.SABLE=2]="SABLE",e[e.TERRE=3]="TERRE",e[e.PIERRE=4]="PIERRE",e[e.LAVE=5]="LAVE",e[e.EAU=6]="EAU",e[e.FORET=7]="FORET",e[e.PLAINE=8]="PLAINE",e}({});class c{constructor(e,l,n){this.x=e,this.y=l,this.celluleType=n,this.selected=!1,this.accessible=!1,this.contenu=[],this.meeplesPresents=[],this.cssTerrain="",this.visible=!1,this.dormeur=void 0,this.setTYPE_CELLULE(n),this.contenu=[]}removeMeeplePresent(e){this.meeplesPresents=this.meeplesPresents.filter(l=>l!=e)}setTYPE_CELLULE(e){switch(this.celluleType=e,e){case r.EAU:this.bgX=23,this.bgY=29,this.bgColor="#EEEEEE",this.cssTerrain="eau";break;case r.MER:this.bgX=23,this.bgY=29,this.cssTerrain="mer";break;case r.PIERRE:this.bgX=30,this.bgY=24,this.cssTerrain="pierre";break;case r.SABLE:this.bgX=5,this.bgY=1,this.cssTerrain="sable";break;case r.TERRE:this.bgX=4,this.bgY=0,this.cssTerrain="terre";break;case r.FORET:const e=Math.floor(4*Math.random());0===e?(this.bgX=19,this.bgY=19):1===e?(this.bgX=20,this.bgY=19):2===e?(this.bgX=21,this.bgY=19):(this.bgX=22,this.bgY=19),this.cssTerrain="foret";break;case r.PLAINE:this.bgX=12,this.bgY=0,this.cssTerrain="plaine"}}addObject(e){this.contenu.push(e)}}const a={BOIS:"w",TISSU:"t",EAU:"e",ARGILE:"a",MINERAI_FER:"i",FER:"f",PLANCHE:"p",VIANDE:"v",POISSON:"o",PIERRE:"r",CORDE:"c",HERBE:"h"};class p{constructor(e={}){this.elements=e}static from(e){const l={};return e.split("").forEach(e=>{l[e]?l[e]+=1:l[e]=1}),new p(l)}add(e){Object.keys(e.elements).forEach(l=>{this.elements[l]?this.elements[l]+=e.elements[l]:this.elements[l]=e.elements[l]})}moreThan(e){let l=!0;return Object.keys(e.elements).forEach(n=>l=l&&this.elements[n]&&this.elements[n]>e.elements[n]),l}remove(e){Object.keys(e.elements).forEach(l=>{this.elements[l]&&(this.elements[l]-=e.elements[l])})}}var h=function(e){return e[e.TRAVAIL=0]="TRAVAIL",e[e.RECOLTE=1]="RECOLTE",e[e.EXPLORATION=2]="EXPLORATION",e[e.CHASSE=3]="CHASSE",e[e.PECHE=4]="PECHE",e[e.LOISIR=5]="LOISIR",e[e.CONSTRUCTION=6]="CONSTRUCTION",e}({});class b{constructor(e,l,n,t,s,i,u){this.typeAction=e,this.description=l,this.objet=n,this.cout=t,this.energie=s,this.terrain=i,this.batiment=u}}const E={EXPLORATION_1:new b(h.EXPLORATION,"Explorer les environs",null,p.from(""),1,null,null),EXPLORATION_2:new b(h.EXPLORATION,"Explorer mieux les environs",null,p.from(""),2,null,null),TRAVAIL:new b(h.TRAVAIL,"Travailler dans le b\xe2timent",null,p.from(""),1,null,null),REPARATION:new b(h.CONSTRUCTION,"R\xe9parer le b\xe2timent",null,p.from(""),1,null,null),CHASSE_P_1:new b(h.CHASSE,"Ramassage de larves. E: 3 nourritures",null,p.from(""),1,r.PLAINE,null),CHASSE_P_2:new b(h.CHASSE,"Collets pour li\xe8vres. E: 6 nourritures",null,p.from("h"),1,r.PLAINE,null),CHASSE_P_3:new b(h.CHASSE,"Collets pour li\xe8vres. EE: 9 nourritures",null,p.from("h"),2,r.PLAINE,null),RECOLTE_P_1:new b(h.RECOLTE,"R\xe9colte. E: 2 herbes",null,p.from(""),1,r.PLAINE,null),RECOLTE_P_2:new b(h.RECOLTE,"R\xe9colte. EE: 3 herbes, 2 baies",null,p.from(""),1,r.PLAINE,null),CHASSE_F_1:new b(h.CHASSE,"Recherche d'oeufs. E: 3 nourritures",null,p.from(""),1,r.FORET,null),RECOLTE_F_1:new b(h.RECOLTE,"R\xe9colte de bois. E: 2 bois",null,p.from(""),1,r.FORET,null),RECOLTE_F_2:new b(h.CHASSE,"Recherche d'oeufs. E: 3 nourritures",null,p.from(""),1,r.FORET,null),PECHE_E_1:new b(h.PECHE,"Recherche de langoustes. E: 3 nourritures",null,p.from(""),1,r.EAU,null),PECHE_E_2:new b(h.PECHE,"Pose de pi\xe8ges \xe0 poissons. E: 10 nourritures",null,p.from("hh"),1,r.EAU,null),CONSTRUCTION_E_1:new b(h.CONSTRUCTION,"Construction de carri\xe8re d'argile. E: 10 nourritures",null,p.from("hh"),1,r.EAU,null)};class m{constructor(e){this.partieService=e,this.TYPE_CELLULE=r,this.TYPE_ACTION=h}ngOnInit(){}ngOnChanges(e){console.log("changes de meeple"),console.log(e),this.meeple.action||(this.actions=this.partieService.getActionsPossibles(this.meeple))}doAction(e){console.log("action"),this.partieService.executeAction(this.meeple,e)}}var d=function(e){return e[e.ACTION=0]="ACTION",e[e.LOG=1]="LOG",e[e.SELECT=2]="SELECT",e[e.MOVE=3]="MOVE",e}({}),g=function(e){return e[e.NONE=0]="NONE",e[e.MEEPLE=1]="MEEPLE",e[e.CELLULE=2]="CELLULE",e}({});class f{constructor(e,l){this.messageType=e,this.target=l}}class C{constructor(e,l){this.nom=e,this.description=l}}new C("Ronfleur","G\xeane les gens dormant dans la m\xeame pi\xe8ce ou \xe0 proximit\xe9"),new C("Gros mangeur","A besoin de plus de nourriture pour \xeatre rassasi\xe9"),new C("Petit mangeur","A besoin de moins de nourriture pour \xeatre rassasi\xe9"),new C("Germophobe","Refuse tout contact avec des malades ou bless\xe9s"),new C("Pacifiste","D\xe9teste la violence"),new C("Jovial","S'entend facilement avec les autres"),new C("M\xe9disant","Se f\xe2che facilement avec les autres"),new C("Jaloux","Est susceptible aux diff\xe9rences de traitement"),new C("Int\xe9rieur","Pr\xe9f\xe8re travailler \xe0 l'int\xe9rieur. +1 joie"),new C("Ext\xe9rieur","Pr\xe9f\xe8re travailler \xe0 l'ext\xe9rieur. +1 joie"),new C("","");class P{constructor(e,l,n,t){this.id=e,this.symbole=l,this.nom=n,this.naissance=t,this.selected=!1,this.traits=[],this.energie=2,this.energieMax=2,this.sante=3,this.histoire=[],this.actions=2,this.deplacementMax=3,this.deplacement=0}aTrait(e){return this.traits.indexOf(e)>-1}setPosition(e){e!==this.position&&(this.position.removeMeeplePresent(this),e.meeplesPresents.push(this),this.position=e)}ajouteHistoire(){this.histoire.unshift({})}}class O{constructor(e,l,n,t){this.posX=e,this.posY=l,this.sizeX=n,this.sizeY=t}}class M{constructor(e,l,n){return this.nom=e,this.description=l,this.cout=n,this}withSpriteCoords(e,l,n,t){return this.sprite=new O(e,l,n,t),this}}const T={ROBOT:new M("Robot","Votre robot",new p).withSpriteCoords(49,1,2,2),FEU_DE_CAMP:new M("Feu de camp","Petit feu pour se chauffer et cuisiner",new p({B:1})),PUITS:new M("Puits","Trou dans la terre",new p),FOYER:new M("Foyer","Feu de camp am\xe9lior\xe9",new p({P:4,B:2})),HUTTE:new M("Hutte","Abri pour dormir",new p({P:4,B:2})).withSpriteCoords(72,11,3,4),CABANE:new M("Cabane","Abri",new p({P:4,B:2})),LOGE:new M("Loge","Abri",new p({P:4,B:2})),MINE_ARGILE:new M("Cabane","Abri",new p({P:4,B:2})),CARRIERE_PIERRE:new M("Cabane","Abri",new p({P:4,B:2})),ATELIER:new M("Aterlier","Abri",new p({P:4,B:2})),MAISON:new M("Cabane","Abri",new p({P:4,B:2})),SIDO:new M("Sido","Maison avec toit rouge et murs blancs",new p({P:4,B:2}))};class v{constructor(e,l,n){this.cellule=e,this.proto=l}}function A(e,l){return Math.floor(Math.random()*(l+1-e)+e)}class L{constructor(e,l){this.nom=e,this.description=l}}class I extends L{constructor(e,l,n,t){super(n,t),this.code=e,this.cout=l}}const w=[];function _(e){w[e.code]=e}_(new I("rec","","recolte","")),_(new I("rech","","recherche","")),_(new I("def","","defense","")),_(new I("hunt","","chasse","")),_(new I("expl","","exploration","")),_(new I("cstr","","construction","")),_(new I("eau","2","eau","fournit 10 rations d'eau")),_(new I("eau 2","2","eau niveau 2","fournit 30 rations d'eau")),_(new I("cstr 2","","construction avanc\xe9e","")),_(new I("chal","","chaleur","")),_(new I("heal","","soin mineur","")),_(new I("heal 2","","soin majeur","")),_(new I("def","","defense","")),_(new I("rem","","remove",""));var R=function(e){return e[e.CONCILIANT=0]="CONCILIANT",e[e.NORMAL=1]="NORMAL",e[e.EXIGEANT=2]="EXIGEANT",e}({});class S{constructor(){this.status=R.CONCILIANT,this.logs=[],this.reserve={},this.cartesMain=[],this.meeples=[],this.batiments=[],this.plansDisponibles=[],this.dateDemarrage=A(100,200),this.date=1,this.generalId=1,this.meepleSyllabes=["ga","fur","gol","bo","ber","dil","ne","zu","ra","meu","mul","ta","ni"]}addBatiment(e,l){const n=new v(e,l,[]);this.batiments.push(n),e.batiment=n}sendMeeple(e,l){const n=e.position;n&&(console.log(n.meeplesPresents,e,n.meeplesPresents.filter(l=>l.id!==e.id)),n.meeplesPresents=n.meeplesPresents.filter(l=>l.id!==e.id),console.log(n.meeplesPresents)),l.meeplesPresents.push(e),e.position=l}log(e){this.logs.push(e)}initReserve(){this.reserve=p.from("eeeeewwwph")}initRobot(){this.cartesPaquet=[],this.cartesMain=[],this.cartesDefausse=[],this.cartesPaquet=[w.expl,w.rec,w.hunt,w.rech,w.def,w.cstr],function(e){for(let l=e.length-1;l>0;l--){const n=Math.floor(Math.random()*l+1),t=e[n];e[n]=e[l],e[l]=t}}(this.cartesPaquet),this.piocheX(4)}piocheX(e){for(let l=0;l<e;l++)console.log("pioche"),this.pioche()}defausseMain(){const e=this.cartesMain.length;for(let l=0;l<e;l++)this.cartesDefausse.push(this.cartesMain.pop())}pioche(){this.cartesPaquet.length>0?this.cartesMain.push(this.cartesPaquet.pop()):this.cartesDefausse.length>0&&(this.log("Remelange de la d\xe9fausse dans la pioche"),this.cartesDefausse.forEach(e=>this.cartesPaquet.push(e)),this.cartesDefausse=[],this.cartesMain.push(this.cartesPaquet.pop()))}generateMeeples(){const e=this.generateMeeple(A(20,40)),l=this.generateMeeple(A(20,40)),n=this.generateMeeple(A(20,40));this.meeples.push(e),this.sendMeeple(e,this.terrain.getVoisin(this.batiments[0].cellule,1,0)),this.setCouche(e,this.terrain.getVoisin(this.batiments[0].cellule,1,0)),this.meeples.push(l),this.sendMeeple(l,this.terrain.getVoisin(this.batiments[0].cellule,-1,0)),this.setCouche(l,this.terrain.getVoisin(this.batiments[0].cellule,-1,0)),this.meeples.push(n),this.sendMeeple(n,this.terrain.getVoisin(this.batiments[0].cellule,0,-1)),this.setCouche(n,this.terrain.getVoisin(this.batiments[0].cellule,0,-1))}setCouche(e,l){const n=e.couche;n&&(n.dormeur=void 0),l.dormeur=e,e.couche=l}generateMeeple(e){const l=new P(this.generalId++,"M"+this.generalId,this.generateMeepleName(),this.dateDemarrage-e);return l.color1="rgb("+A(0,255)+","+A(0,255)+","+A(0,255)+")",l.color2="rgb("+A(0,255)+","+A(0,255)+","+A(0,255)+")",l}generateMeepleName(){const e=A(2,4);let l="";for(let t=0;t<e;t++)l=l.concat((n=this.meepleSyllabes)[A(0,n.length-1)]);var n;return l.substring(0,10)}finTour(){this.meeples.forEach(e=>{e.ajouteHistoire()}),this.doActions(),this.doMeepleDrink(),this.doMeepleEat(),this.doMeepleSleep(),this.defausseMain(),this.piocheX(4)}doActions(){this.meeples.forEach(e=>{})}doMeepleSleep(){this.meeples.forEach(e=>{e.couche.batiment?e.couche.batiment.proto===T.HUTTE?e.histoire[0].sommeil=1:e.couche.batiment.proto===T.CABANE&&(e.histoire[0].sommeil=2):e.histoire[0].sommeil=0}),this.log("Pas assez de nourriture pour tous.")}doMeepleEat(){const e=2*this.meeples.length,l=this.reserve[a.VIANDE];if(this.log(this.meeples.length+" meeples mangent chacun 2 portions \xe7a fait "+e+" portions"),this.log("Il y a "+l+" unit\xe9s de nourriture de 4 portions chacune."),e>=l/4)this.log("Tout le monde mange"),this.reserve.bouffe-=e,this.meeples.forEach(e=>{e.histoire[0].bouffe=2});else if(e>=l/2){const l=Math.ceil(e/4);this.log("Restriction de bouffe: une seule portion soit "+l+" unit\xe9s."),this.reserve.bouffe-=l,this.meeples.forEach(e=>{e.histoire[0].bouffe=1})}else this.log("Pas assez de nourriture pour tous."),this.meeples.forEach(e=>{e.histoire[0].bouffe=0})}doMeepleDrink(){const e=this.meeples.length;e>this.reserve[a.EAU]?(this.meeples.forEach(e=>{e.histoire[0].eau=0}),this.log("Pas assez d'eau pour tous.")):(this.meeples.forEach(e=>{e.histoire[0].eau=1}),this.log("Tout le monde boit"),this.reserve.eau-=e)}}class x extends c{constructor(e,l,n){super(e,l,n),this.hx=e-5-Math.floor((l-4)/2),this.hz=l-4,this.hy=-this.hx-this.hz}}class N{constructor(e,l){this.tailleX=e,this.tailleY=l,this.cases=[],this.cases=[];for(let n=0;n<l;n++){const l=[];this.cases.push(l);for(let t=0;t<e;t++)l.push(new x(t,n,r.PLAINE))}}getCellule(e,l){return this.cases[(l+this.tailleY)%this.tailleY][(e+this.tailleX)%this.tailleX]}setCellule(e,l,n){this.getCellule(e,l).celluleType=n}getVoisin(e,l,n){return this.getCellule(e.x+l,e.y+n)}getDistance(e,l){return Math.abs(e.x-l.x)+Math.abs(e.y-l.y)}getHexDistance(e,l){return(Math.abs(e.hx-l.hx)+Math.abs(e.hy-l.hy)+Math.abs(e.hz-l.hz))/2}getHexVoisins(e,l){const n=[];for(const t of this.cases)for(const s of t){const t=this.getHexDistance(s,e);t>0&&t<=l&&n.push(s)}return console.log("voinsins",n),n}getVoisins(e,l){const n=[];for(let t of this.cases)for(let s of t){let t=this.getDistance(s,e);t>0&&t<=l&&n.push(s)}return n}setVisible(e){e.visible=!0}setVisibleAvecVoisins(e){this.setVisible(e),this.setVisible(this.getVoisin(e,1,0)),this.setVisible(this.getVoisin(e,-1,0)),this.setVisible(this.getVoisin(e,0,1)),this.setVisible(this.getVoisin(e,0,-1))}}var k=n("XNiG");let y=(()=>{class e{constructor(){this.channel=new k.a,this.channelSelected=new k.a}sendMessage(e){switch(console.log("send mesg",e),e.messageType){case d.SELECT:this.channelSelected.next(e);break;default:this.channel.next(e)}}getChannel(){return this.channel.asObservable()}getChannelSelected(){return this.channelSelected.asObservable()}}return e.ngInjectableDef=t.Kb({factory:function(){return new e},token:e,providedIn:"root"}),e})(),U=(()=>{class e{constructor(e){this.messageService=e,this.selectedElement={type:g.NONE},this.partie=new S,this.initPartie()}executeAction(e,l){console.log("action",e,l),e.deplacement=e.deplacementMax,e.action=l,this.unselectMeeple(e)}initPartie(){this.partie.terrain=this.buildTerrain();const e=this.partie.terrain.getCellule(7,4);this.partie.addBatiment(e,T.ROBOT),e.visible=!0,this.partie.terrain.getHexVoisins(e,2).forEach(e=>e.visible=!0),this.partie.generateMeeples(),this.partie.initReserve(),this.partie.plansDisponibles.push(T.HUTTE,T.FEU_DE_CAMP,T.MINE_ARGILE),this.partie.log("Init fini")}getPartie(){return this.partie}endStep(){[].push("a"),this.partie.meeples.forEach(e=>{e.deplacement=0,e.action&&(console.log("meeple action ",e.action),e.action.typeAction===h.EXPLORATION&&this.partie.terrain.getHexVoisins(e.position,2).map(e=>e.visible=!0),e.action.typeAction===h.CONSTRUCTION&&(e.position.batiment=new v(e.position,e.action.batiment,[]))),e.action=void 0})}unselect(){this.partie.terrain.cases.map(e=>e.map(e=>e.accessible=!1)),this.selectedElement.meeple&&(this.selectedElement.meeple.selected=!1,this.selectedElement.meeple=void 0),this.selectedElement.cellule&&(this.selectedElement.cellule.selected=!1,this.selectedElement.cellule=void 0),this.selectedElement.type=g.NONE}selectCellule(e){if(console.log("elect",this.selectedElement),this.selectedElement.meeple&&e.visible){const l=this.selectedElement.meeple,n=this.partie.terrain.getHexDistance(e,l.position);n>l.deplacementMax-l.deplacement?this.messageService.sendMessage(new f(d.LOG,"trop loin")):(this.getPartie().sendMeeple(this.selectedElement.meeple,e),l.deplacement+=n,this.messageService.sendMessage(new f(d.MOVE,e)),this.unselect(),this.messageService.sendMessage(new f(d.SELECT,this.selectedElement)))}else this.unselect(),this.selectedElement={type:g.CELLULE,cellule:e},e.selected=!0,this.messageService.sendMessage(new f(d.SELECT,this.selectedElement))}unselectMeeple(e){this.unselect(),e.selected=!1,this.messageService.sendMessage(new f(d.SELECT,this.selectedElement))}selectMeeple(e){this.selectedElement.meeple===e?this.unselectMeeple(e):(this.unselect(),e.selected=!0,this.selectedElement.meeple=e,this.selectedElement.type=g.MEEPLE,this.showAccessibles(e.position,e.deplacementMax-e.deplacement),this.messageService.sendMessage(new f(d.SELECT,this.selectedElement)))}showAccessibles(e,l){this.partie.terrain.getHexVoisins(e,l).map(e=>{e.visible&&(e.accessible=!0)})}getActionsPossibles(e){const l=[];switch(e.position.batiment?(l.push(E.TRAVAIL),l.push(E.REPARATION)):this.partie.plansDisponibles.forEach(e=>{l.push(new b(h.CONSTRUCTION,"Construire",null,p.from(""),1,null,e))}),l.push(E.EXPLORATION_1),e.position.celluleType){case r.FORET:l.push(E.CHASSE_F_1),l.push(E.RECOLTE_F_1);break;case r.PLAINE:l.push(E.CHASSE_P_1),l.push(E.CHASSE_P_2),l.push(E.RECOLTE_P_1),l.push(E.RECOLTE_P_2);break;case r.EAU:l.push(E.PECHE_E_1)}return l}buildTerrain(){const e=new N(12,8);for(let l=0;l<12;l++)for(let n=0;n<8;n++)(l<2||l<3&&n>2||l<4&&n>3)&&e.getCellule(l,n).setTYPE_CELLULE(r.FORET),(l>10||l>9&&n<6||l>8&&n<4)&&e.getCellule(l,n).setTYPE_CELLULE(r.PIERRE);e.getCellule(5,0).setTYPE_CELLULE(r.EAU),e.getCellule(6,0).setTYPE_CELLULE(r.EAU),e.getCellule(6,1).setTYPE_CELLULE(r.EAU),e.getCellule(7,1).setTYPE_CELLULE(r.EAU),e.getCellule(8,1).setTYPE_CELLULE(r.EAU),e.getCellule(8,2).setTYPE_CELLULE(r.EAU);for(let l=9;l<12;l++)e.getCellule(l,2).setTYPE_CELLULE(r.EAU);return e}}return e.ngInjectableDef=t.Kb({factory:function(){return new e(t.Lb(y))},token:e,providedIn:"root"}),e})();var Y=t.nb({encapsulation:0,styles:[[".meeple-infos[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}.meeple-infos[_ngcontent-%COMP%]   .sub-infos[_ngcontent-%COMP%]{border:1px solid gold;padding:10px}.meeple-infos[_ngcontent-%COMP%]   .cellule[_ngcontent-%COMP%], .meeple-infos[_ngcontent-%COMP%]   .meeple[_ngcontent-%COMP%]{width:40%}"]],data:{}});function G(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,1,"button",[],null,[[null,"click"]],(function(e,l,n){var t=!0;return"click"===l&&(t=!1!==e.component.doAction(e.parent.context.$implicit)&&t),t}),null,null)),(e()(),t.Eb(2,null,[""," : ",""]))],null,(function(e,l){e(l,2,0,l.parent.context.$implicit.description,null==l.parent.context.$implicit.batiment?null:l.parent.context.$implicit.batiment.nom)}))}function V(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,1,"button",[],null,[[null,"click"]],(function(e,l,n){var t=!0;return"click"===l&&(t=!1!==e.component.doAction(e.parent.context.$implicit)&&t),t}),null,null)),(e()(),t.Eb(2,null,["",""]))],null,(function(e,l){e(l,2,0,l.parent.context.$implicit.description)}))}function H(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,1,"button",[],null,[[null,"click"]],(function(e,l,n){var t=!0;return"click"===l&&(t=!1!==e.component.doAction(e.parent.context.$implicit)&&t),t}),null,null)),(e()(),t.Eb(2,null,["",""]))],null,(function(e,l){e(l,2,0,l.parent.context.$implicit.description)}))}function F(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,1,"button",[],null,[[null,"click"]],(function(e,l,n){var t=!0;return"click"===l&&(t=!1!==e.component.doAction(e.parent.context.$implicit)&&t),t}),null,null)),(e()(),t.Eb(2,null,["",""]))],null,(function(e,l){e(l,2,0,l.parent.context.$implicit.description)}))}function B(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,8,"div",[],null,null,null,null,null)),(e()(),t.eb(16777216,null,null,1,null,G)),t.ob(2,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(e()(),t.eb(16777216,null,null,1,null,V)),t.ob(4,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(e()(),t.eb(16777216,null,null,1,null,H)),t.ob(6,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(e()(),t.eb(16777216,null,null,1,null,F)),t.ob(8,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null)],(function(e,l){var n=l.component;e(l,2,0,l.context.$implicit.typeAction===n.TYPE_ACTION.CONSTRUCTION),e(l,4,0,l.context.$implicit.typeAction===n.TYPE_ACTION.EXPLORATION),e(l,6,0,l.context.$implicit.typeAction===n.TYPE_ACTION.RECOLTE),e(l,8,0,l.context.$implicit.typeAction===n.TYPE_ACTION.TRAVAIL)}),null)}function X(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,4,"div",[],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),t.Eb(-1,null,["Actions possibles"])),(e()(),t.eb(16777216,null,null,1,null,B)),t.ob(4,278528,null,0,o.j,[t.M,t.J,t.q],{ngForOf:[0,"ngForOf"]},null)],(function(e,l){e(l,4,0,l.component.actions)}),null)}function D(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),t.Eb(1,null,[" "," "]))],null,(function(e,l){e(l,1,0,l.component.meeple.action.description)}))}function J(e){return t.Gb(2,[(e()(),t.pb(0,0,null,null,23,"div",[["class","meeple-infos"]],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,15,"div",[["class","sub-infos meeple"]],null,null,null,null,null)),(e()(),t.pb(2,0,null,null,8,"span",[],null,null,null,null,null)),t.Cb(512,null,o.x,o.y,[t.k,t.r,t.B]),t.ob(4,278528,null,0,o.n,[o.x],{ngStyle:[0,"ngStyle"]},null),t.Bb(5,{border:0,padding:1,"border-radius":2}),(e()(),t.pb(6,0,null,null,4,"span",[],null,null,null,null,null)),t.Cb(512,null,o.x,o.y,[t.k,t.r,t.B]),t.ob(8,278528,null,0,o.n,[o.x],{ngStyle:[0,"ngStyle"]},null),t.Bb(9,{border:0,padding:1,"border-radius":2}),(e()(),t.Eb(10,null,[" "," (",") "])),(e()(),t.pb(11,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),t.Eb(12,null,["sante: ",""])),(e()(),t.pb(13,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),t.Eb(14,null,["d\xe9placements: ","/",""])),(e()(),t.pb(15,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),t.Eb(16,null,["energie "," // ",""])),(e()(),t.pb(17,0,null,null,6,"div",[["class","sub-infos cellule"]],null,null,null,null,null)),(e()(),t.pb(18,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),t.Eb(19,null,["",""])),(e()(),t.eb(16777216,null,null,1,null,X)),t.ob(21,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(e()(),t.eb(16777216,null,null,1,null,D)),t.ob(23,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null)],(function(e,l){var n=l.component,t=e(l,5,0,"2px solid "+n.meeple.color1,"1.5px 0","10px");e(l,4,0,t);var s=e(l,9,0,"2px solid "+n.meeple.color2,"0 3px","8px");e(l,8,0,s),e(l,21,0,n.actions&&!n.meeple.action),e(l,23,0,n.meeple.action)}),(function(e,l){var n=l.component;e(l,10,0,n.meeple.nom,n.meeple.symbole),e(l,12,0,n.meeple.sante),e(l,14,0,n.meeple.deplacement,n.meeple.deplacementMax),e(l,16,0,n.meeple.energie,n.meeple.energieMax),e(l,19,0,n.meeple.position.cssTerrain)}))}class ${constructor(e){this.partieService=e,this.TYPE_CELLULE=r}ngOnInit(){console.log("on init",this.cellule)}select(){console.log("select C"),this.partieService.selectCellule(this.cellule)}selectMeeple(e,l){console.log("select M"),e.stopPropagation(),this.partieService.selectMeeple(l)}}var j=t.nb({encapsulation:0,styles:[[".cellule-container[_ngcontent-%COMP%]{position:relative;width:50px;height:40px;border:1px solid #d3d3d3}.cellule-container.eau[_ngcontent-%COMP%]{background-color:#c6fbff}.cellule-container.mer[_ngcontent-%COMP%]{background-color:#b9caff}.cellule-container.foret[_ngcontent-%COMP%]{background-color:#b2c2aa}.cellule-container.plaine[_ngcontent-%COMP%]{background-color:#dadab6}.cellule-container.pierre[_ngcontent-%COMP%]{background-color:#8d8d89}.cellule-container.selected[_ngcontent-%COMP%]{border:1px solid #fff9c7}.cellule-container.accessible[_ngcontent-%COMP%]{border:1px solid #4aff4a}.cellule-container[_ngcontent-%COMP%]   .arriere-plan[_ngcontent-%COMP%]{position:absolute;width:50px;height:40px;background:url(/assets/tileset.png) bottom/16px 16px;clip:rect(0,16px,0,16px)}.cellule-container[_ngcontent-%COMP%]   .cellule[_ngcontent-%COMP%]{position:absolute;width:50px;height:40px}.cellule-container[_ngcontent-%COMP%]   .cellule.invisible[_ngcontent-%COMP%]{background-color:#a9a9a9}.cellule-container[_ngcontent-%COMP%]   .meeple[_ngcontent-%COMP%]{border:1px solid #fff;cursor:col-resize;background-color:#edffe1}.cellule-container[_ngcontent-%COMP%]   .meeple.deplacable[_ngcontent-%COMP%]{background-color:#4aff4a}.cellule-container[_ngcontent-%COMP%]   .meeple.fini[_ngcontent-%COMP%]{background-color:#000;color:#fff}.cellule-container[_ngcontent-%COMP%]   .meeple.selected[_ngcontent-%COMP%]{border:1px solid #fff9c7}.cellule-container[_ngcontent-%COMP%]   .batiment[_ngcontent-%COMP%]{color:#fff;background-color:#c06743;padding:2px}"]],data:{}});function q(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),t.Eb(1,null,[" "," "," "]))],null,(function(e,l){var n=l.component;e(l,1,0,n.cellule.contenu,null==n.cellule.dormeur?null:n.cellule.dormeur.symbole)}))}function z(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,4,"span",[["class","meeple"]],null,[[null,"click"]],(function(e,l,n){var t=!0;return"click"===l&&(t=!1!==e.component.selectMeeple(n,e.context.$implicit)&&t),t}),null,null)),t.Cb(512,null,o.v,o.w,[t.q,t.r,t.k,t.B]),t.ob(2,278528,null,0,o.i,[o.v],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t.Bb(3,{selected:0,deplacable:1,fini:2}),(e()(),t.Eb(4,null,["",""]))],(function(e,l){var n=e(l,3,0,l.context.$implicit.selected,l.context.$implicit.deplacement<l.context.$implicit.deplacementMax,l.context.$implicit.action);e(l,2,0,"meeple",n)}),(function(e,l){e(l,4,0,l.context.$implicit.symbole)}))}function K(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,2,"span",[],null,null,null,null,null)),(e()(),t.eb(16777216,null,null,1,null,z)),t.ob(2,278528,null,0,o.j,[t.M,t.J,t.q],{ngForOf:[0,"ngForOf"]},null)],(function(e,l){e(l,2,0,l.component.cellule.meeplesPresents)}),null)}function Q(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,1,"div",[["class","batiment"]],null,null,null,null,null)),(e()(),t.Eb(1,null,[" "," "]))],null,(function(e,l){e(l,1,0,l.component.cellule.batiment.proto.nom)}))}function W(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,14,"div",[["class","cellule-container"]],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,3,"div",[["class","arriere-plan"]],null,null,null,null,null)),t.Cb(512,null,o.v,o.w,[t.q,t.r,t.k,t.B]),t.ob(3,278528,null,0,o.i,[o.v],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t.Bb(4,{selected:0,eau:1,mer:2,foret:3,plaine:4,terre:5}),(e()(),t.pb(5,0,null,null,9,"div",[["class","cellule"]],null,[[null,"click"]],(function(e,l,n){var t=!0;return"click"===l&&(t=!1!==e.component.select()&&t),t}),null,null)),t.Cb(512,null,o.v,o.w,[t.q,t.r,t.k,t.B]),t.ob(7,278528,null,0,o.i,[o.v],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),t.Bb(8,{accessible:0,invisible:1}),(e()(),t.eb(16777216,null,null,1,null,q)),t.ob(10,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(e()(),t.eb(16777216,null,null,1,null,K)),t.ob(12,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(e()(),t.eb(16777216,null,null,1,null,Q)),t.ob(14,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null)],(function(e,l){var n=l.component,t=e(l,4,0,n.cellule.selected,n.cellule.celluleType===n.TYPE_CELLULE.EAU,n.cellule.celluleType===n.TYPE_CELLULE.MER,n.cellule.celluleType===n.TYPE_CELLULE.FORET,n.cellule.celluleType===n.TYPE_CELLULE.PLAINE,n.cellule.celluleType===n.TYPE_CELLULE.TERRE);e(l,3,0,"arriere-plan",t);var s=e(l,8,0,n.cellule.accessible,!n.cellule.visible);e(l,7,0,"cellule",s),e(l,10,0,n.cellule.visible),e(l,12,0,n.cellule.meeplesPresents),e(l,14,0,n.cellule.batiment)}),null)}class Z{constructor(){}ngOnInit(){}}var ee=t.nb({encapsulation:0,styles:[[".terrain-container[_ngcontent-%COMP%]{width:100%;overflow:scroll}.terrain-container[_ngcontent-%COMP%]   .carte[_ngcontent-%COMP%]{font-size:8px;display:inline-grid}.terrain-container[_ngcontent-%COMP%]   .carte[_ngcontent-%COMP%]   .ligne[_ngcontent-%COMP%]{display:inline-flex}.terrain-container[_ngcontent-%COMP%]   .carte[_ngcontent-%COMP%]   .ligne[_ngcontent-%COMP%]:nth-child(2n){margin-left:25px}"]],data:{}});function le(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,2,"td",[],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,1,"app-cellule",[],null,null,null,W,j)),t.ob(2,114688,null,0,$,[U],{cellule:[0,"cellule"]},null)],(function(e,l){e(l,2,0,l.context.$implicit)}),null)}function ne(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,2,"tr",[["class","ligne"]],null,null,null,null,null)),(e()(),t.eb(16777216,null,null,1,null,le)),t.ob(2,278528,null,0,o.j,[t.M,t.J,t.q],{ngForOf:[0,"ngForOf"]},null)],(function(e,l){e(l,2,0,l.context.$implicit)}),null)}function te(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,3,"div",[["class","terrain-container "]],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,2,"table",[["class","carte"]],null,null,null,null,null)),(e()(),t.eb(16777216,null,null,1,null,ne)),t.ob(3,278528,null,0,o.j,[t.M,t.J,t.q],{ngForOf:[0,"ngForOf"]},null)],(function(e,l){e(l,3,0,l.component.terrain.cases)}),null)}class se{constructor(e,l){this.ms=e,this.partieService=l,this.TYPE_TARGET=g,this.logs=[],this.selectedElement=void 0,this.subs=this.ms.getChannel().subscribe(e=>this.onMessage(e)),this.subs2=this.ms.getChannelSelected().subscribe(e=>this.onMessageSelected(e)),this.selectedElement=this.partieService.selectedElement}getTitle(){return console.log("get"),"title"}ngOnInit(){}onMessageSelected(e){console.log("on msg selected",e),this.selectedElement=e.target}onMessage(e){switch(e.messageType){case d.LOG:this.log(e.target)}}log(e){this.logs.push(e)}endStep(){this.partieService.endStep()}}var ie=t.nb({encapsulation:0,styles:[[""]],data:{}});function ue(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,5,"div",[],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,1,"h4",[],null,null,null,null,null)),(e()(),t.Eb(-1,null,["Batiment: "])),(e()(),t.Eb(3,null,[" "," "])),(e()(),t.pb(4,0,null,null,0,"br",[],null,null,null,null,null)),(e()(),t.Eb(5,null,[" "," "]))],null,(function(e,l){var n=l.component;e(l,3,0,n.selectedElement.cellule.batiment.proto.nom),e(l,5,0,n.selectedElement.cellule.batiment.proto.description)}))}function oe(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,5,"div",[],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,1,"h4",[],null,null,null,null,null)),(e()(),t.Eb(-1,null,["Cellule"])),(e()(),t.Eb(3,null,[" "," "])),(e()(),t.eb(16777216,null,null,1,null,ue)),t.ob(5,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null)],(function(e,l){e(l,5,0,l.component.selectedElement.cellule.batiment)}),(function(e,l){e(l,3,0,l.component.selectedElement.cellule.cssTerrain)}))}function re(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,1,"app-meeple-infos",[],null,null,null,J,Y)),t.ob(2,638976,null,0,m,[U],{meeple:[0,"meeple"]},null)],(function(e,l){e(l,2,0,l.component.selectedElement.meeple)}),null)}function ce(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,7,"div",[["class","selection"]],null,null,null,null,null)),(e()(),t.eb(16777216,null,null,1,null,oe)),t.ob(2,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(e()(),t.eb(16777216,null,null,1,null,re)),t.ob(4,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(e()(),t.pb(5,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),t.pb(6,0,null,null,1,"button",[],null,[[null,"click"]],(function(e,l,n){var t=!0;return"click"===l&&(t=!1!==e.component.endStep()&&t),t}),null,null)),(e()(),t.Eb(-1,null,["Fin de l'\xe9tape"]))],(function(e,l){var n=l.component;e(l,2,0,n.selectedElement.type==n.TYPE_TARGET.CELLULE),e(l,4,0,n.selectedElement.type===n.TYPE_TARGET.MEEPLE)}),null)}function ae(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),t.Eb(1,null,["",""]))],null,(function(e,l){e(l,1,0,l.context.$implicit)}))}function pe(e){return t.Gb(2,[(e()(),t.pb(0,0,null,null,1,"div",[["class","partie-infos"]],null,null,null,null,null)),(e()(),t.Eb(1,null,[" Jour "," - "])),(e()(),t.pb(2,0,null,null,1,"app-terrain",[],null,null,null,te,ee)),t.ob(3,114688,null,0,Z,[],{terrain:[0,"terrain"]},null),(e()(),t.eb(16777216,null,null,1,null,ce)),t.ob(5,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(e()(),t.pb(6,0,null,null,2,"div",[["class","logs"]],null,null,null,null,null)),(e()(),t.eb(16777216,null,null,1,null,ae)),t.ob(8,278528,null,0,o.j,[t.M,t.J,t.q],{ngForOf:[0,"ngForOf"]},null),(e()(),t.pb(9,0,null,null,9,"div",[["class",""]],null,null,null,null,null)),(e()(),t.Eb(-1,null,[" Futures \xe9volutinos: "])),(e()(),t.pb(11,0,null,null,0,"br",[],null,null,null,null,null)),(e()(),t.Eb(-1,null,[" plusieurs types de civilisations: les mechs qui ont besoin d'\xe9nergie mais pas de nourriture "])),(e()(),t.pb(13,0,null,null,0,"br",[],null,null,null,null,null)),(e()(),t.Eb(-1,null,[" les homoncules qui ne font qu'une activit\xe9 jusqu'\xe0 leur mort "])),(e()(),t.pb(15,0,null,null,0,"br",[],null,null,null,null,null)),(e()(),t.Eb(-1,null,[" les ch\xe9p\xe9quoi qui sont tr\xe8s efficaces mais ne supportent pas la violence ni l'inaction "])),(e()(),t.pb(17,0,null,null,0,"br",[],null,null,null,null,null)),(e()(),t.Eb(-1,null,[" jouer un marchand qui va de colons en colons marchander\n"]))],(function(e,l){var n=l.component;e(l,3,0,n.partie.terrain),e(l,5,0,n.selectedElement),e(l,8,0,n.logs)}),(function(e,l){e(l,1,0,l.component.partie.date)}))}var he=t.nb({encapsulation:0,styles:[[""]],data:{}});function be(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),t.pb(1,0,null,null,1,"app-partie",[],null,null,null,pe,ie)),t.ob(2,114688,null,0,se,[y,U],{partie:[0,"partie"]},null)],(function(e,l){e(l,2,0,l.component.partie)}),null)}function Ee(e){return t.Gb(0,[(e()(),t.eb(16777216,null,null,1,null,be)),t.ob(1,16384,null,0,o.k,[t.M,t.J],{ngIf:[0,"ngIf"]},null)],(function(e,l){e(l,1,0,l.component.partie)}),null)}function me(e){return t.Gb(0,[(e()(),t.pb(0,0,null,null,1,"app-start",[],null,null,null,Ee,he)),t.ob(1,114688,null,0,s,[U],null,null)],(function(e,l){e(l,1,0)}),null)}var de=t.lb("app-start",s,me,{},{},[]),ge=n("iInd");n.d(l,"MeeplesModuleNgFactory",(function(){return fe}));var fe=t.mb(i,[],(function(e){return t.xb([t.yb(512,t.j,t.X,[[8,[u.a,de]],[3,t.j],t.v]),t.yb(4608,o.m,o.l,[t.s,[2,o.A]]),t.yb(1073742336,o.b,o.b,[]),t.yb(1073742336,ge.m,ge.m,[[2,ge.r],[2,ge.k]]),t.yb(1073742336,i,i,[]),t.yb(1024,ge.i,(function(){return[[{path:"",component:s}]]}),[])])}))}}]);